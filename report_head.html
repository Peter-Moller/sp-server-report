<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<title>Backup report for “DOMAIN” on REPORT_TODAY</title>
<style type="text/css" media="screen">
* {
    margin: 0px 0px 0px 0px;
    padding: 0px 0px 0px 0px;
}
body, html {
    padding: 3px 3px 3px 3px;
    background-color: #D8DBE2;
    font-family: Frutiger, Helvetica, Arial, sans-serif;
    font-size: 10pt;
    text-align: center;
}
div.main_page {
    position: relative;
    display: table;
    margin-bottom: 3px;
    margin-left: auto;
    margin-right: auto;
    padding: 10px 30px 10px 30px;
    border-width: 0px;
    border-color: #212738;
    border-style: solid;
    background-color: #FFFFFF;
    text-align: center;
}
#CS table {
table-layout: fixed;
width: 100%;
border-collapse: collapse;
border: 3px solid purple;
}
code { padding: 1px 2px; color: #875e29; background-color: #d9ebdb; border-radius:2px }
#jobe {
    border-collapse: collapse;
    width: 100%;
    border-spacing: 0px;
    position: relative;
}
#jobe td {
    border: 1px solid #ddd;
    padding: 4px;
	vertical-align: top;
}
#jobe th {
    color: white;
    padding: 4px;
    text-align: center;
    background-color: #000080;
    cursor: pointer;
    position: sticky;
	top: 0;
    vertical-align: bottom;
}
#jobe tr:nth-child(even) {
    background-color: white;
    color: black;
}
#jobe tr:nth-child(odd) {
    background-color: #EBEBEB;
}
#jobe tr:hover {
    background-color: #9c6114;
    color: white
}
#jobe th.sorted-asc,
#jobe th.sorted-desc {
    background-color: #0000DD; /* Light blue background */
    /*color: #003366;            /* Dark blue text */
}
.sort-arrow {
  color: #F9A510;
}
#searchbar {
    margin-left: 40px;
    padding: 5px;
    border-radius: 7px;
}
input[type=text] {
    width: 15%;
    -webkit-transition: width 0.15s ease-in-out;
    transition: width 0.15s ease-in-out;
}
/* When the input field gets focus, change its width to 100% */
input[type=text]:focus {
    width: 30%;
}
#explanations {
    border-collapse: separate;
	border-spacing: 3px;
}
#explanations td {
    padding-left: 3px;
    padding-right: 10px;
    padding-top: 1px;
    padding-bottom: 2px;
	text-align: left;
	vertical-align: top;
}
.search-input {
    border: none;
    outline: none;
    background-color: #0000C0;
    color: white;
    font-style: bold
}
	</style>
	<style>
.flexbox-container {
    display: flex;
}
.flexbox-item {
    margin: 10px;
    border: 3px #333;
}
.flexbox-item-0 {
    width: 80px;
    margin: 10px;
    border: 3px #333;
}
.box {
    flex: 1;
}
#box-explanations {
    background: #f0eee5;
    border-radius: 10px;
    margin: 10px;
    padding: 10px;
}
#box-documentation {
    background: #b4d7b8;
    border-radius: 10px;
    margin: 10px;
    padding: 10px;
}
@font-face {
	font-family: 'Glyphicons Halflings';
	src: url(https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/fonts/glyphicons-halflings-regular.eot);
	src: url(https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/fonts/glyphicons-halflings-regular.eot?#iefix) format('embedded-opentype'), url(https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/fonts/glyphicons-halflings-regular.woff2) format('woff2'), url(https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/fonts/glyphicons-halflings-regular.woff) format('woff'), url(https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/fonts/glyphicons-halflings-regular.ttf) format('truetype'), url(https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/fonts/glyphicons-halflings-regular.svg#glyphicons_halflingsregular) format('svg')
}
.glyphicon {
	position: relative;
	top: 1px;
	display: inline-block;
	font-family: 'Glyphicons Halflings';
	font-style: normal;
	font-weight: 400;
  font-size: 90%;
	line-height: 1;
	-webkit-font-smoothing: antialiased;
	-moz-osx-font-smoothing:grayscale
}
.glyphicon-new-window:before { content: "\e164" }
</style>
<script type="text/javascript">
function sortTable(n, restoreDir = null) {
    const table = document.getElementById("jobe");
    const headers = table.getElementsByTagName("TH");
    let switching = true;
    let dir = restoreDir || "asc";
    let switchcount = 0;

    // Clear previous sort indicators and styles
    for (let j = 0; j < headers.length; j++) {
        headers[j].classList.remove("sorted-asc", "sorted-desc");
        headers[j].innerHTML = headers[j].innerHTML.replace(/[▲▼]/g, '');
    }

    while (switching) {
        switching = false;
        const rows = table.rows;

        for (let i = 1; i < (rows.length - 1); i++) {
            let shouldSwitch = false;
            const x = rows[i].getElementsByTagName("TD")[n];
            const y = rows[i + 1].getElementsByTagName("TD")[n];
            shouldSwitch = compare(x.textContent || x.innerText, y.textContent || y.innerText, dir === "asc");
            if (shouldSwitch) {
                rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                switching = true;
                switchcount++;
                break;
            }
        }

        if (!switchcount && dir === "asc" && !restoreDir) {
            dir = "desc";
            switching = true;
        }
    }

    // Add sort indicator and style
    const arrow = dir === "asc" ? "▲" : "▼";
    headers[n].classList.add(dir === "asc" ? "sorted-asc" : "sorted-desc");
    headers[n].innerHTML += ` <span class="sort-arrow">${arrow}</span>`;

    // Save sort state
    localStorage.setItem("sortedColumn", n);
    localStorage.setItem("sortDirection", dir);
}

function compare(x, y, asc) {
    return function(v1, v2) {
        v1 = v1.replaceAll(',', '');
        v2 = v2.replaceAll(',', '');

        if (v1.includes(' KB') || v1.includes(' MB') || v1.includes(' GB')) {
            v1 = cleanupBytesColumnForComparison(v1);
            v2 = cleanupBytesColumnForComparison(v2);
        }

        return (v1 !== '' && v2 !== '' && !isNaN(v1) && !isNaN(v2))
            ? Number(v1) > Number(v2)
            : v1.toString().toLowerCase().localeCompare(v2) > 0;
    }(asc ? x : y, asc ? y : x);
}

function cleanupBytesColumnForComparison(value) {
    if (value.includes(' KB')) return Number(value.slice(0, -3));
    if (value.includes(' MB')) return Number(value.slice(0, -3)) * 1000;
    if (value.includes(' GB')) return Number(value.slice(0, -3)) * 1000000;
    return value;
}

function search_client() {
    let input = document.getElementById('searchbar').value
    input = input.toLowerCase();
    let x = document.getElementsByClassName('clients');

    for (i = 0; i < x.length; i++) {
        if (!x[i].innerHTML.toLowerCase().includes(input)) {
            x[i].style.display = "none";
        } else {
            x[i].style.display = "";
        }
    }
}
</script>
</head>
<body>
<div class="main_page">
  <h3>Spectrum Protect</h3>
  <h1>REPORT_H1_HEADER </h1>
  <h2>REPORT_DATETIME</h2>
  <p>&nbsp;</p>
  <!-- input tag -->
  
  <p align="left">REPORT_HEAD <input id="searchbar" onkeyup="search_client()" type="text"	name="search" placeholder="Search..."></p>
  <p align="left">&nbsp;</p>
  <table id="jobe">
    <thead>
      <tr>
        <th onclick="sortTable(0)">Client&nbsp;name</th>
        <th align="right" onclick="sortTable(1)">Objects<br>backed</th>
        <th onclick="sortTable(2)">Bytes<br>transferred</th>
        <th onclick="sortTable(3)">Elapsed<br>time</th>
        <th onclick="sortTable(4)">Backup<br>status</th>
        <!--<th onclick="sortTable(5)">Client network</th>-->
        <th align="right" onclick="sortTable(5)">Files on<br>server</th>
        <th align="right" onclick="sortTable(6)">Volume on<br>server&nbsp;[GB]</th>
        <!--<th align="right" onclick="sortTable(8)"># FS</th>-->
        <th onclick="sortTable(7)">Client<br>version</th>
        <th onclick="sortTable(8)">PVU</th>
        <th onclick="sortTable(9)">Client<br>Operating System</th>
        <th onclick="sortTable(10)">Errors&nbsp;encountered</th>
      </tr>
    </thead>
    <tbody>
